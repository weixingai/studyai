# AI 规则

了解如何通过规则系统来控制 AI 的行为

## 概述

Cursor 的 AI 规则系统允许你定义 AI 在处理代码时应该遵循的规则。这些规则可以帮助确保 AI 生成的代码符合你的编码标准和最佳实践。

## 规则文件

规则存储在项目根目录下的 `.aiconfig` 文件中。这个文件使用 YAML 格式，可以包含多个规则定义。

基本的规则文件结构如下：

```yaml
rules:
  - name: "规则名称"
    description: "规则描述"
    pattern: "要匹配的模式"
    message: "违反规则时显示的消息"
```

## 规则类型

Cursor 支持多种类型的规则：

### 1. 代码风格规则

这些规则定义了代码的格式化和风格要求：
- 缩进规则
- 命名约定
- 空格使用

### 2. 最佳实践规则

这些规则强制执行编程最佳实践：
- 错误处理要求
- 注释规范
- 代码复杂度限制

### 3. 安全规则

这些规则帮助防止常见的安全问题：
- 敏感数据处理
- 输入验证
- 认证要求

## 规则示例

以下是一些常见规则示例：

```yaml
rules:
  - name: "强制使用类型注解"
    description: "所有函数参数必须包含类型注解"
    pattern: "def *\\([^:]+\\)"
    message: "请为函数参数添加类型注解"

  - name: "禁止使用 print"
    description: "生产环境代码中禁止使用 print 语句"
    pattern: "print\\("
    message: "请使用日志记录而不是 print 语句"
```

## 规则优先级

当多个规则适用时，规则按以下优先级执行：

1. 安全规则（最高优先级）
2. 最佳实践规则
3. 代码风格规则（最低优先级）

## 规则作用域

规则可以应用于不同的作用域：

- 全局规则：应用于整个项目
- 目录规则：仅应用于特定目录
- 文件规则：仅应用于特定文件类型

## 禁用规则

在特定情况下，你可以通过以下方式临时禁用规则：

1. 在代码中使用特殊注释：
```python
# ai-disable-rule: rule-name
代码...
# ai-enable-rule: rule-name
```

2. 在 `.aiconfig` 文件中设置例外：
```yaml
exceptions:
  - rule: "规则名称"
    paths:
      - "tests/*"
      - "scripts/debug.py"
```

## 最佳实践

使用 AI 规则时的建议：

1. 从少量基本规则开始
2. 逐步添加更多规则
3. 定期审查和更新规则
4. 确保团队成员了解所有规则
5. 为规则提供清晰的文档说明

## 规则维护

为确保规则系统的有效性：

- 定期检查规则的相关性
- 更新规则以适应新的需求
- 删除过时或不再适用的规则
- 监控规则的影响和效果

## 故障排除

如果遇到规则相关的问题：

1. 检查规则语法是否正确
2. 验证规则模式是否匹配预期的代码
3. 确保规则之间没有冲突
4. 查看规则的应用日志

## 结论

AI 规则系统是确保代码质量和一致性的强大工具。通过适当的配置和维护，它可以显著提高团队的开发效率和代码质量。 